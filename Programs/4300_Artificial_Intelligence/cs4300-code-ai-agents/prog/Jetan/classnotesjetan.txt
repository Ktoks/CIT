multithreading - spawn a thread for each top-level branches
